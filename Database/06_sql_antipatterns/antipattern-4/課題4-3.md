## 課題3-1

どんなサービスを開発している時に[課題1](課題4-1.md)のようなアンチパターンに陥りそうでしょうか？
最低でも1つは例を考えてみてください。

例：Twitterのようなサービスを開発していると仮定する

- 投稿に対するいいねとリツイートに対するいいねを管理したい
    - 「Like」「Tweet」「Retweet」テーブルが生まれて
    - 「Like」テーブルに`type`や`belongs_to_id`カラムが生まれるとアンチパターンに陥る、など


### サービス事例

#### 1. スラックなどのスレッドが生まれるサービス

- スレッドに対する返信機能を実装する場合
    - 「thread」テーブルに`parent_id`カラムを追加して階層構造を表現
    - 深い階層のコメントを取得する際に複雑なJOINが必要になる


#### 2.社員管理システム
- 部署やチームの階層構造を管理する場合
    - 「Department」テーブルに`parent_id`カラムを追加
    - 組織の再編成時に複雑な更新が必要
    - 特定の部署の下位組織を全て取得するのが非効率
    - 組織の移動時に整合性を保つのが困難

#### 3.デリバリー注文サービス

- 商品のバリエーション管理（サイズ、トッピング、オプションなど）を実装する場合
    - 「Product」テーブルに`parent_id`カラムを追加して商品の階層構造を表現
    - 例：ハンバーガー（親）→ サイズ（子）→ トッピング（孫）のような階層
        - 特定の商品の全バリエーションを取得するのが非効率
        - 商品の価格計算時に階層を遡る必要があり、複雑なクエリが必要
        - 商品の削除時に子商品の処理が複雑
        - 商品の移動や更新時に整合性を保つのが困難
        - 注文履歴との関連付けが複雑になる